{% extends "base.html" %}
{% block content %}
<section class="hero">
  <div>
    <h1>Cellar telemetry at a glance.</h1>
    <p class="lead">Live readouts for thermals, pump output, and fan RPMs. Profiles and screens are staged until you deploy them.</p>
  </div>
  <div class="status-card">
    <div class="status-card__label">System Pulse</div>
    <div class="status-card__value">Nominal</div>
    <div class="status-card__sub">Awaiting liquidctl integration</div>
  </div>
</section>

<section class="grid">
  <div class="metric-card">
    <div class="metric-card__label">CPU Temp</div>
    <div class="metric-card__value" data-metric="cpu_temp">{{ metrics.cpu_temp if metrics else "--" }}°C</div>
    <div class="metric-card__sub">Pi core</div>
  </div>
  <div class="metric-card">
    <div class="metric-card__label">Ambient Temp</div>
    <div class="metric-card__value" data-metric="ambient_temp">{{ metrics.ambient_temp if metrics else "--" }}°C</div>
    <div class="metric-card__sub">I2C sensors</div>
  </div>
  <div class="metric-card">
    <div class="metric-card__label">Fan RPM</div>
    <div class="metric-card__value" data-metric="fan_rpm">{{ metrics.fan_rpm if metrics else "--" }}</div>
    <div class="metric-card__sub">Aggregate sample</div>
  </div>
  <div class="metric-card">
    <div class="metric-card__label">Pump %</div>
    <div class="metric-card__value" data-metric="pump_percent">{{ metrics.pump_percent if metrics else "--" }}%</div>
    <div class="metric-card__sub">Remote PWM board</div>
  </div>
</section>

<section class="split">
  <div class="panel">
    <div class="panel__header">
      <h2>Fan Channels</h2>
      <span class="panel__tag">Configurable</span>
    </div>
    <div class="fan-grid">
      {% for fan in fans %}
      <div class="fan-tile">
        <div class="fan-tile__title">{{ fan.name }}</div>
        <div class="fan-tile__value">-- RPM</div>
        <div class="fan-tile__sub">Awaiting live feed</div>
      </div>
      {% endfor %}
    </div>
  </div>
  <div class="panel">
    <div class="panel__header">
      <h2>Temperature Trend</h2>
      <span class="panel__tag">Last 12 samples</span>
    </div>
    <div class="sparkline__toggles">
      <label class="toggle">
        <input type="checkbox" data-target="cpu-line" checked />
        <span>CPU</span>
      </label>
      <label class="toggle">
        <input type="checkbox" data-target="ambient-line" checked />
        <span>Ambient</span>
      </label>
      <label class="toggle">
        <input type="checkbox" data-target="fan-line" checked />
        <span>Fan RPM</span>
      </label>
      <label class="toggle">
        <input type="checkbox" data-target="pump-line" checked />
        <span>Pump %</span>
      </label>
    </div>
    <div class="sparkline">
      <div class="sparkline__label">CPU Temp</div>
      <svg viewBox="0 0 140 40" class="sparkline__chart" aria-hidden="true">
        <polyline id="cpu-line" points="{{ cpu_points }}" fill="none" stroke="var(--accent)" stroke-width="2" />
      </svg>
    </div>
    <div class="sparkline">
      <div class="sparkline__label">Ambient Temp</div>
      <svg viewBox="0 0 140 40" class="sparkline__chart" aria-hidden="true">
        <polyline id="ambient-line" points="{{ ambient_points }}" fill="none" stroke="var(--alert)" stroke-width="2" />
      </svg>
    </div>
    <div class="sparkline">
      <div class="sparkline__label">Fan RPM</div>
      <svg viewBox="0 0 140 40" class="sparkline__chart" aria-hidden="true">
        <polyline id="fan-line" points="{{ fan_points }}" fill="none" stroke="#22c55e" stroke-width="2" />
      </svg>
    </div>
    <div class="sparkline">
      <div class="sparkline__label">Pump %</div>
      <svg viewBox="0 0 140 40" class="sparkline__chart" aria-hidden="true">
        <polyline id="pump-line" points="{{ pump_points }}" fill="none" stroke="#f97316" stroke-width="2" />
      </svg>
    </div>
    <div class="sparkline__note">Historical samples are seeded until ingestion is wired in.</div>
  </div>
</section>
<script src="/static/js/dashboard.js"></script>
{% endblock %}
